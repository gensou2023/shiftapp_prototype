<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ShiftOptimizer AI - シフト最適化デモ</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ===== Navigation ===== -->
<nav class="nav">
  <div class="nav-brand">
    <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
      <rect x="3" y="3" width="18" height="18" rx="4" stroke="#5b9aff" stroke-width="2"/>
      <path d="M7 12h10M7 8h6M7 16h8" stroke="#5b9aff" stroke-width="2" stroke-linecap="round"/>
    </svg>
    <span>ShiftOptimizer AI</span>
  </div>
  <div class="nav-tabs-container">
    <div class="nav-tab active" data-page="dashboard">ダッシュボード</div>
    <div class="nav-tab" data-page="staff">スタッフ一覧</div>
    <div class="nav-tab" data-page="generate">シフト生成</div>
    <div class="nav-tab" data-page="calendar">カレンダー</div>
  </div>
  <div class="nav-spacer"></div>
  <div class="nav-user">
    <button class="nav-settings-btn" onclick="openSettingsModal()" title="設定">
      <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
        <path d="M9 11.25a2.25 2.25 0 100-4.5 2.25 2.25 0 000 4.5z" stroke="currentColor" stroke-width="1.5"/>
        <path d="M14.7 11.1l.6 1.1a1 1 0 01-.2 1.2l-1.1.9a1 1 0 01-1.2 0l-.9-.6a5.5 5.5 0 01-1.9.8v1.1a1 1 0 01-1 1h-1a1 1 0 01-1-1v-1.1a5.5 5.5 0 01-1.9-.8l-.9.6a1 1 0 01-1.2 0l-1.1-.9a1 1 0 01-.2-1.2l.6-1.1a5.5 5.5 0 01-.4-2.1c0-.7.1-1.4.4-2.1l-.6-1.1a1 1 0 01.2-1.2l1.1-.9a1 1 0 011.2 0l.9.6a5.5 5.5 0 011.9-.8V2.4a1 1 0 011-1h1a1 1 0 011 1v1.1a5.5 5.5 0 011.9.8l.9-.6a1 1 0 011.2 0l1.1.9a1 1 0 01.2 1.2l-.6 1.1c.3.7.4 1.4.4 2.1s-.1 1.4-.4 2.1z" stroke="currentColor" stroke-width="1.5"/>
      </svg>
    </button>
    <div class="nav-avatar">村</div>村田さん
  </div>
</nav>

<!-- ===== Dashboard ===== -->
<div class="page active" id="page-dashboard">
  <div class="page-inner">
    <h1 class="page-title">ダッシュボード</h1>
    <p class="page-subtitle">シフト管理の概要</p>

    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-label">登録スタッフ</div>
        <div class="stat-value" id="stat-staff">8</div>
        <div class="stat-sub">全員アクティブ</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">今週のシフト</div>
        <div class="stat-value">156</div>
        <div class="stat-sub">充足率 92%</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">本日の出荷レベル</div>
        <div class="stat-value" style="color: var(--color-warning);">通常</div>
        <div class="stat-sub">必要スコア: 40</div>
      </div>
    </div>

    <div class="quick-actions">
      <button class="btn btn-primary btn-lg" onclick="switchPage('generate')">
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><path d="M9 3v12M3 9h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        AIでシフトを生成
      </button>
      <button class="btn btn-secondary btn-lg" onclick="switchPage('staff')">
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><circle cx="9" cy="6" r="3" stroke="currentColor" stroke-width="1.5"/><path d="M3 16c0-3.3 2.7-6 6-6s6 2.7 6 6" stroke="currentColor" stroke-width="1.5"/></svg>
        スタッフ一覧
      </button>
    </div>

    <!-- Day Timeline -->
    <div class="day-timeline-section">
      <div class="day-timeline-title">
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><circle cx="9" cy="9" r="7" stroke="currentColor" stroke-width="1.5"/><path d="M9 5v4.5l3 1.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        本日のシフトタイムライン
      </div>
      <div id="day-timeline" class="timeline-container"></div>
    </div>

    <!-- 3-Slot Summaries -->
    <div class="slot-summaries" id="slot-summaries"></div>
  </div>
</div>

<!-- ===== Staff List ===== -->
<div class="page" id="page-staff">
  <div class="page-inner">
    <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:var(--space-2);margin-bottom:var(--space-2);">
      <h1 class="page-title" style="margin-bottom:0;">スタッフ一覧</h1>
      <button class="btn btn-primary" onclick="openStaffModal()">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M8 3v10M3 8h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        スタッフ追加
      </button>
      <button class="btn btn-secondary" onclick="openCsvModal()">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M2 11v2a1 1 0 001 1h10a1 1 0 001-1v-2M5 6l3-3 3 3M8 3v8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        CSV取込
      </button>
    </div>
    <p class="page-subtitle">登録されているスタッフの情報を管理します</p>
    <div class="dept-filters" id="dept-filters">
      <button class="dept-filter active" data-dept="all" onclick="filterDept(this)">全て<span class="dept-count" id="count-all"></span></button>
      <button class="dept-filter" data-dept="出荷・検品" onclick="filterDept(this)">出荷・検品<span class="dept-count" id="count-a"></span></button>
      <button class="dept-filter" data-dept="入荷・仕分け" onclick="filterDept(this)">入荷・仕分け<span class="dept-count" id="count-b"></span></button>
      <button class="dept-filter" data-dept="物流・加工" onclick="filterDept(this)">物流・加工<span class="dept-count" id="count-c"></span></button>
      <button class="dept-filter" data-dept="夜間作業" onclick="filterDept(this)">夜間作業<span class="dept-count" id="count-d"></span></button>
    </div>
    <div class="staff-count-info" id="staff-count-info"></div>
    <div class="staff-grid" id="staff-grid"></div>
  </div>
</div>

<!-- ===== Shift Generator ===== -->
<div class="page" id="page-generate">
  <div class="page-inner">
    <h1 class="page-title">AIシフト生成</h1>
    <p class="page-subtitle">出荷量に応じた最適なシフトをAIが自動生成します</p>

    <div class="shift-gen-layout">
      <div class="shift-input-panel">
        <div class="card">
          <div class="card-header">入力条件</div>
          <div class="card-body">
            <div class="form-group">
              <label class="form-label">日付</label>
              <input type="date" class="form-input shift-date-input" id="shift-date">
            </div>
            <div class="form-group">
              <label class="form-label">時間帯</label>
              <div class="slot-toggles" id="slot-toggles">
                <button class="slot-toggle active" data-slot="早番" onclick="selectSlot(this)">早番</button>
                <button class="slot-toggle" data-slot="遅番" onclick="selectSlot(this)">遅番</button>
                <button class="slot-toggle" data-slot="夜勤" onclick="selectSlot(this)">夜勤</button>
                <button class="slot-toggle" data-slot="通し" onclick="selectSlot(this)">通し</button>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">出荷量レベル</label>
              <div class="level-buttons" id="level-buttons">
                <button class="level-btn" data-level="軽量" onclick="selectLevel(this)">
                  <span class="level-name">軽量</span>
                  <span class="level-score">必要スコア: 20</span>
                </button>
                <button class="level-btn active" data-level="通常" onclick="selectLevel(this)">
                  <span class="level-name">通常</span>
                  <span class="level-score">必要スコア: 40</span>
                </button>
                <button class="level-btn" data-level="繁忙" onclick="selectLevel(this)">
                  <span class="level-name">繁忙</span>
                  <span class="level-score">必要スコア: 60</span>
                </button>
                <button class="level-btn" data-level="超繁忙" onclick="selectLevel(this)">
                  <span class="level-name">超繁忙</span>
                  <span class="level-score">必要スコア: 80</span>
                </button>
              </div>
            </div>

            <div class="shift-info-box" id="shift-info-box">
              <div class="shift-info-row">
                <span>必要スコア</span>
                <strong id="info-required-score">40</strong>
              </div>
              <div class="shift-info-row">
                <span>出勤可能スタッフ</span>
                <strong id="info-available-count">-</strong>
              </div>
            </div>

            <button class="btn btn-primary btn-generate" id="btn-generate" onclick="generateShift()">
              <span class="pulse"></span>
              <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><path d="M9 2l2.1 4.3 4.7.7-3.4 3.3.8 4.7L9 12.8 4.8 15l.8-4.7L2.2 7l4.7-.7L9 2z" stroke="currentColor" stroke-width="1.5" fill="none"/></svg>
              AIでシフト生成
            </button>
          </div>
        </div>
      </div>

      <div>
        <div class="view-toggle" id="view-toggle" style="display:none;">
          <button class="view-toggle-btn active" data-view="daily" onclick="switchView('daily')">1日表示</button>
          <button class="view-toggle-btn" data-view="weekly" onclick="switchView('weekly')">週間表示</button>
        </div>
        <div class="shift-results" id="shift-results">
        <div class="result-placeholder">
          <div class="result-placeholder-icon">&#128197;</div>
          <div style="font-size:16px;font-weight:600;margin-bottom:var(--space-2);">シフトを生成してください</div>
          <div>左の条件を設定し「AIでシフト生成」ボタンをクリック</div>
        </div>
      </div>
      </div>
    </div>
  </div>
</div>

<!-- ===== Calendar ===== -->
<div class="page" id="page-calendar">
  <div class="page-inner">
    <h1 class="page-title">シフトカレンダー</h1>
    <p class="page-subtitle">月間のシフト状況を一覧できます</p>

    <div class="calendar-header">
      <div class="calendar-nav">
        <button class="calendar-nav-btn" onclick="changeMonth(-1)">&lt;</button>
        <span class="calendar-month" id="calendar-month"></span>
        <button class="calendar-nav-btn" onclick="changeMonth(1)">&gt;</button>
      </div>
      <div>
        <span class="badge badge-success" style="margin-right:4px;">充足</span>
        <span class="badge badge-warning" style="margin-right:4px;">不足気味</span>
        <span class="badge badge-danger" style="margin-right:4px;">人員不足</span>
        <span class="badge badge-muted">休み</span>
      </div>
    </div>

    <div class="calendar-grid-wrapper">
      <div class="calendar-grid" id="calendar-grid"></div>
    </div>

    <div class="calendar-list" id="calendar-list"></div>

    <div class="calendar-detail" id="calendar-detail">
      <div class="card">
        <div class="card-header">
          <span id="detail-date">-</span>
          <button class="btn btn-sm btn-secondary" onclick="document.getElementById('calendar-detail').classList.remove('active')">閉じる</button>
        </div>
        <div class="card-body" id="detail-body"></div>
      </div>
    </div>
  </div>
</div>

<!-- ===== Staff Edit Modal ===== -->
<div class="modal-overlay" id="staff-modal">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" id="modal-title">スタッフ追加</div>
      <button class="modal-close" onclick="closeStaffModal()">&times;</button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="edit-staff-id">
      <div class="form-group">
        <label class="form-label">名前</label>
        <input type="text" class="form-input" id="edit-name" placeholder="例: 佐藤 浩司">
      </div>
      <div class="form-group">
        <label class="form-label">部署</label>
        <select class="form-select" id="edit-dept">
          <option value="出荷・検品">出荷・検品</option>
          <option value="入荷・仕分け">入荷・仕分け</option>
          <option value="物流・加工">物流・加工</option>
          <option value="夜間作業">夜間作業</option>
        </select>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">スキルレベル（1-5）</label>
          <input type="number" class="form-input" id="edit-skill" min="1" max="5" value="3">
        </div>
        <div class="form-group">
          <label class="form-label">時給（円）</label>
          <input type="number" class="form-input" id="edit-rate" value="1050" step="50">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">貢献度（0.5-2.0）</label>
        <input type="number" class="form-input" id="edit-weight" min="0.5" max="2.0" step="0.1" value="1.0">
      </div>
      <div class="form-group">
        <label class="form-label">出勤可能曜日</label>
        <div class="checkbox-group" id="edit-days">
          <label class="checkbox-item"><input type="checkbox" value="月"> 月</label>
          <label class="checkbox-item"><input type="checkbox" value="火"> 火</label>
          <label class="checkbox-item"><input type="checkbox" value="水"> 水</label>
          <label class="checkbox-item"><input type="checkbox" value="木"> 木</label>
          <label class="checkbox-item"><input type="checkbox" value="金"> 金</label>
          <label class="checkbox-item"><input type="checkbox" value="土"> 土</label>
          <label class="checkbox-item"><input type="checkbox" value="日"> 日</label>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">出勤可能時間帯</label>
        <div class="checkbox-group" id="edit-slots">
          <label class="checkbox-item"><input type="checkbox" value="早番"> 早番</label>
          <label class="checkbox-item"><input type="checkbox" value="遅番"> 遅番</label>
          <label class="checkbox-item"><input type="checkbox" value="夜勤"> 夜勤</label>
          <label class="checkbox-item"><input type="checkbox" value="通し"> 通し</label>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">備考</label>
        <input type="text" class="form-input" id="edit-note" placeholder="例: フォークリフト資格">
      </div>
      <div id="staff-detail-panel" style="display:none;">
        <div class="staff-detail-section">
          <div class="staff-detail-section-title">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/><path d="M8 5v3.5l2.5 1.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
            詳細情報
          </div>
          <div class="staff-detail-grid">
            <div class="staff-detail-item">
              <div class="staff-detail-label">入社日</div>
              <div class="staff-detail-value" id="detail-hire-date">-</div>
            </div>
            <div class="staff-detail-item">
              <div class="staff-detail-label">勤続年数</div>
              <div class="staff-detail-value" id="detail-tenure">-</div>
            </div>
          </div>
        </div>
        <div class="staff-detail-section" style="border-top:none;margin-top:0;padding-top:0;">
          <div class="staff-detail-section-title">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M2 12l3-4 3 2 4-6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
            スキル推移
          </div>
          <div class="skill-timeline" id="detail-skill-timeline"></div>
        </div>
        <div class="staff-detail-section" style="border-top:none;margin-top:0;padding-top:0;">
          <div class="staff-detail-section-title">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="2" y="3" width="12" height="10" rx="2" stroke="currentColor" stroke-width="1.5"/><path d="M2 7h12" stroke="currentColor" stroke-width="1.5"/></svg>
            部署履歴
          </div>
          <ul class="dept-history-list" id="detail-dept-history"></ul>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeStaffModal()">キャンセル</button>
      <button class="btn btn-primary" onclick="saveStaff()">保存</button>
    </div>
  </div>
</div>

<div class="screen-label" id="screen-label">DEMO: ダッシュボード</div>
<div class="toast" id="toast"></div>

<!-- ===== Settings Modal ===== -->
<div class="modal-overlay" id="settings-modal">
  <div class="modal" style="max-width:520px;">
    <div class="modal-header">
      <div class="modal-title">設定</div>
      <button class="modal-close" onclick="closeSettingsModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="settings-tabs">
        <button class="settings-tab active" data-settings-tab="display" onclick="switchSettingsTab('display')">表示設定</button>
        <button class="settings-tab" data-settings-tab="notifications" onclick="switchSettingsTab('notifications')">通知設定</button>
        <button class="settings-tab" data-settings-tab="account" onclick="switchSettingsTab('account')">アカウント</button>
      </div>
      <div class="settings-tab-content active" id="settings-display">
        <div class="settings-item">
          <div><div class="settings-item-label">ダークヘッダー</div><div class="settings-item-desc">ナビゲーションバーの背景色を暗くします</div></div>
          <label class="toggle-switch"><input type="checkbox" id="setting-dark-header" checked onchange="updateSetting('darkHeader', this.checked)"><span class="toggle-slider"></span></label>
        </div>
        <div class="settings-item">
          <div><div class="settings-item-label">コンパクトモード</div><div class="settings-item-desc">余白を減らして情報密度を高めます</div></div>
          <label class="toggle-switch"><input type="checkbox" id="setting-compact" onchange="updateSetting('compactMode', this.checked)"><span class="toggle-slider"></span></label>
        </div>
        <div class="settings-item">
          <div><div class="settings-item-label">デフォルトページ</div><div class="settings-item-desc">アプリ起動時に表示するページ</div></div>
          <select class="settings-select" id="setting-default-page" onchange="updateSetting('defaultPage', this.value)">
            <option value="dashboard">ダッシュボード</option>
            <option value="staff">スタッフ一覧</option>
            <option value="generate">シフト生成</option>
            <option value="calendar">カレンダー</option>
          </select>
        </div>
      </div>
      <div class="settings-tab-content" id="settings-notifications">
        <div class="settings-item">
          <div><div class="settings-item-label">シフト変更通知</div><div class="settings-item-desc">シフトが変更された場合に通知します</div></div>
          <label class="toggle-switch"><input type="checkbox" id="setting-notify-shift" checked onchange="updateSetting('notifyShiftChange', this.checked)"><span class="toggle-slider"></span></label>
        </div>
        <div class="settings-item">
          <div><div class="settings-item-label">労務警告通知</div><div class="settings-item-desc">連勤超過やインターバル不足の警告</div></div>
          <label class="toggle-switch"><input type="checkbox" id="setting-notify-labor" checked onchange="updateSetting('notifyLaborWarning', this.checked)"><span class="toggle-slider"></span></label>
        </div>
        <div class="settings-item">
          <div><div class="settings-item-label">欠勤通知</div><div class="settings-item-desc">スタッフが欠勤した場合に通知します</div></div>
          <label class="toggle-switch"><input type="checkbox" id="setting-notify-absence" checked onchange="updateSetting('notifyAbsence', this.checked)"><span class="toggle-slider"></span></label>
        </div>
      </div>
      <div class="settings-tab-content" id="settings-account">
        <div class="settings-account-card">
          <div class="settings-account-avatar">村</div>
          <div class="settings-account-name">村田さん</div>
          <div class="settings-account-role">管理者</div>
        </div>
        <div class="settings-item"><div><div class="settings-item-label">メールアドレス</div><div class="settings-item-desc">murata@example.com</div></div></div>
        <div class="settings-item"><div><div class="settings-item-label">役割</div><div class="settings-item-desc">シフト管理者（全権限）</div></div></div>
        <div style="margin-top:var(--space-6);">
          <button class="btn btn-secondary" style="width:100%;justify-content:center;color:var(--color-danger);border-color:var(--color-danger);" onclick="handleLogout()">ログアウト</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===== CSV Import Modal ===== -->
<div class="modal-overlay" id="csv-modal">
  <div class="modal" style="max-width:600px;">
    <div class="modal-header">
      <div class="modal-title">CSV取込 — スタッフ出勤情報</div>
      <button class="modal-close" onclick="closeCsvModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="csv-format-info">
        <strong>CSVフォーマット:</strong><br>
        <code>名前,出勤可能曜日,出勤可能時間帯</code><br><br>
        <strong>例:</strong><br>
        <code>佐藤 浩司,月火水木金,早番遅番</code><br>
        <code>加藤 隆太,土日,早番</code><br><br>
        ※ 1行目がヘッダー行の場合は自動的にスキップされます<br>
        ※ 曜日: 月火水木金土日 を連続して記述<br>
        ※ 時間帯: 早番・遅番・夜勤・通し を連続して記述
      </div>
      <div class="form-group">
        <label class="form-label">CSVファイル選択</label>
        <input type="file" id="csv-file-input" accept=".csv,text/csv" onchange="handleCsvFileSelect(event)" style="font-size:13px;font-family:inherit;">
      </div>
      <div id="csv-preview-container" style="display:none;">
        <label class="form-label">プレビュー</label>
        <div class="csv-preview-area" id="csv-preview-area"></div>
        <div id="csv-summary"></div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeCsvModal()">キャンセル</button>
      <button class="btn btn-primary" id="csv-apply-btn" onclick="applyCsvData()" disabled>適用</button>
    </div>
  </div>
</div>

<script src="app.js"></script>
</body>
</html>
